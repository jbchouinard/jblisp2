(import-from "stl/unittest"
    test
    test-suite
    assert-raise
    assert-equal
)

(test-suite "functions"
    (test "let bindings"
        (assert-equal 110
            (let x 100
            (let y 10
                (+ x y)))))

    (test "set! unbound raises error"
        (assert-raise (set! unbound)))

    (test "set! changes local binding"
        (assert-equal 7 (
            let x 0
                (set! x 7)
                x)))
)